
ğŸ”’ PHASE 4B-1 REMEDIATION PROMPT (REPLIT)

CONTEXT â€” READ CAREFULLY

You are working on Phase 4B-1 â€” WebWaka Super Admin Dashboard UI.

This is a STRICT REMEDIATION TASK, not new development.

The current implementation is functional but CONSTITUTIONALLY NON-COMPLIANT.

Your task is to refactor the existing codebase to fully align with the
WebWaka Ecosystem Constitution v1.5+ and the locked Phase 4B-1 specification.

ğŸš« DO NOT add features
ğŸš« DO NOT change UI scope or layout
ğŸš« DO NOT introduce new permissions / entitlements / flags
ğŸš« DO NOT re-implement control logic locally
ğŸš« DO NOT proceed if canonical control packages cannot be consumed

â¸»

SOURCE OF TRUTH (IMMUTABLE)

Constitutional Rules (Non-Negotiable):
	1.	UI must be a pure consumer
	2.	ALL visibility decisions MUST flow through Phase 4A control engines
	3.	ZERO local implementations of:
	â€¢	permissions
	â€¢	entitlements
	â€¢	feature flags
	â€¢	dashboard resolution logic
	4.	Evaluation MUST be deterministic
	â€¢	âŒ new Date()
	â€¢	âŒ system time
	â€¢	âŒ randomness

â¸»

ğŸš¨ CURRENT VIOLATIONS (MANDATORY TO FIX)

âŒ Local dashboard control logic exists
âŒ Canonical control packages not consumed
âŒ Control logic located in wrong files
âŒ Direct new Date() usage breaks determinism

These MUST be corrected.

â¸»

ğŸ¯ OBJECTIVE

Bring webwaka-suite-superadmin-dashboard-ui into full constitutional compliance by:
	1.	Removing all local control logic
	2.	Consuming canonical control packages from GitHub
	3.	Centralizing control consumption into a single consumer
	4.	Ensuring deterministic evaluation
	5.	Preserving all existing UI behavior and layout

â¸»

âœ… REQUIRED ACTIONS (STEP-BY-STEP)

1ï¸âƒ£ DELETE LOCAL CONTROL LOGIC (MANDATORY)

Completely remove:

lib/dashboard-control.ts

There must be ZERO locally implemented:
	â€¢	resolveDashboard()
	â€¢	permissions
	â€¢	entitlements
	â€¢	feature flags
	â€¢	visibility logic

â¸»

2ï¸âƒ£ INSTALL CANONICAL CONTROL PACKAGES (MANDATORY)

Add GitHub-based dependencies:

{
  "dependencies": {
    "webwaka-core-dashboard-control": "github:changerplanet/webwaka-core-dashboard-control",
    "webwaka-suite-superadmin-dashboard-control": "github:changerplanet/webwaka-suite-superadmin-dashboard-control"
  }
}

If these cannot be installed â†’ STOP and report immediately.

â¸»

3ï¸âƒ£ CREATE SINGLE CONTROL CONSUMER (MANDATORY)

Create exactly:

src/lib/control-consumer.ts

This file must be the ONLY place importing control logic.

Example structure (adapt, do not copy blindly):

import {
  superAdminDashboardDeclaration
} from "webwaka-suite-superadmin-dashboard-control";

import {
  resolveDashboard,
  generateDashboardSnapshot,
  evaluateFromSnapshot
} from "webwaka-core-dashboard-control";

export {
  superAdminDashboardDeclaration,
  resolveDashboard,
  generateDashboardSnapshot,
  evaluateFromSnapshot
};

ğŸš¨ No other file may import control packages directly.

â¸»

4ï¸âƒ£ REFACTOR UI TO BE PURE CONSUMER

Update UI code so that:
	â€¢	All visibility decisions:
	â€¢	Flow through resolveDashboard(...)
	â€¢	All rendering:
	â€¢	Uses resolved dashboard output
	â€¢	UI contains:
	â€¢	âŒ NO permission checks
	â€¢	âŒ NO entitlement checks
	â€¢	âŒ NO feature flag checks
	â€¢	âŒ NO role logic

UI = render only, never decide.

â¸»

5ï¸âƒ£ FIX DETERMINISM (MANDATORY)

Replace ALL:

new Date()
Date.now()

With:
	â€¢	Explicit evaluationTime passed from context
	â€¢	OR fixed deterministic values for now

NO implicit time usage allowed.

â¸»

6ï¸âƒ£ FIX CI â€” NO MASKED FAILURES

Remove any masking such as:

npm test || true

CI must fail loudly on:
	â€¢	test failure
	â€¢	build failure
	â€¢	lint failure

â¸»

7ï¸âƒ£ VERIFY BEFORE COMMIT (MANDATORY)

Before pushing:
	â€¢	âœ… npm test passes
	â€¢	âœ… npm run build passes
	â€¢	âœ… No local control logic exists
	â€¢	âœ… Only src/lib/control-consumer.ts imports control packages
	â€¢	âœ… UI behavior unchanged visually

â¸»

ğŸ” REQUIRED PROOF (DO NOT SKIP)

Add or update tests proving:
	1.	Dashboard visibility changes when control input changes
	2.	Determinism (same input â†’ same output, tested 10Ã—)
	3.	No UI file imports control logic except control-consumer.ts

â¸»

ğŸ“Œ FINAL COMMIT REQUIREMENTS

Your commit must:
	â€¢	Remove all local control logic
	â€¢	Consume canonical control packages only
	â€¢	Preserve UI behavior
	â€¢	Strengthen CI correctness

â¸»

â›” HARD STOP

After completing this remediation:

â›” STOP
â›” Do NOT proceed to Phase 4C
â›” Await Manus re-verification

â¸»

ACKNOWLEDGEMENT FORMAT

Reply only with:

â€œRemediation acknowledged. Proceeding exactly as instructed.â€

Then execute.

â¸»